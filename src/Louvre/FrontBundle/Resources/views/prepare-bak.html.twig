{% extends '::base.html.twig' %}

{% block css %}
    <link rel="stylesheet" href="{{ asset('css/stripe.css') }}">
{% endblock %}


{% block body %}

    <!--

PayementModel {
  +totalAmount: 24
  +price: array:2 [
    0 => 12
    1 => 12
  ]
  +numberCommand: "LPC5984d1be41cc3"
  +order: OrderModel {
    +visitDate: DateTime {}
    +ticketType: "1"
    +buyerLastName: "yann"
    +buyerFirstName: "clemennt"
    +buyerEmail: "clementyann@free.fr"
    +tickets: array:[
      1 => TicketModel {
        +visitorFullName: "yann clemennt"
        +visitorCountry: "FR"
        +visitorBirthDate: DateTime {}
        +reducedPrices: false
      }
      2 => TicketModel { }
    ]
  }
}
    -->
    <div class="container-fluid">
        <div class="row">

            <div class="col-md-6">
                <div class="row">
                    <table class="table">
                        <tr>
                            <td>N° de commande</td>
                            <td>{{ form.numberCommand }}</td>
                        </tr>
                        <tr>
                            <td>Date de Visite</td>
                            <td>{{ form.order.visitDate | date ('d/m/Y') }}</td>
                        </tr>
                        <tr>
                            <td>Nom</td>
                            <td>{{ form.order.buyerFirstName |upper }} {{ form.order.buyerLastName | e }}</td>
                        </tr>
                        <tr>
                            <td>Email de contact</td>
                            <td>{{ form.order.buyerEmail }}</td>
                        </tr>

                    </table>
                </div>
            </div>

            <div class="col-md-12">
                <div class="row">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Nom du visiteur</th>
                                <th>Type de billet</th>
                                <th>Tarif</th>
                                <th>commentaire</th>
                            </tr>
                        </thead>

                        <tfoot >
                            <tr>
                                <td>Nombre de billet(s) {{ form.price|length }}</td>
                                <td colspan="2">Total de la commande: {{ form.totalAmount }}.00€</td>
                                <td>
                                    <form action="{{ path('louvre_front_confirmed_order') }}" method="POST">
                                        <script
                                                src="https://checkout.stripe.com/checkout.js" class="stripe-button"
                                                data-key="pk_test_aYn42rDsZyeFrQ7kHbjAIz05"
                                                data-amount="{{ form.totalAmount }}00"
                                                data-name="Le Louvre"
                                                data-description="Votre visite du {{ form.order.visitDate | date("d/m/Y") }}"
                                                data-image="https://stripe.com/img/documentation/checkout/marketplace.png"
                                                data-locale="fr"
                                                data-zip-code="true"
                                                data-email="{{ form.order.buyerEmail }}"
                                                data-currency="eur">
                                        </script>
                                    </form>
                                </td>
                            </tr>
                        </tfoot>

                        <tbody>
                            {% for ticket in form.order.tickets %}
                            <tr>
                                <td>
                                    {{ ticket.visitorFullName}}
                                </td>

                                <td>
                                    {% if form.order.ticketType == 1 %}
                                        Billet Journée
                                    {% else %}
                                        Billet demi-journée
                                    {% endif %}
                                </td>

                                <td>
                                    {{ form.price[loop.index0] }}.00 €
                                </td>
                                <td>
                                    {% if ticket.reducedPrices == true %}
                                        <h6>Un justificatif sera necessaire</h6>
                                    {% endif %}
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

{% endblock %}